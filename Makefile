NAME = philo

HEADERS_PATH = ./includes/

INCLUDES = -I$(HEADERS_PATH) 

CFLAGS = -Wall -Wextra -Werror -g3 -pthread
RM = rm -rf

DIR = $(shell pwd)

DIRSRC = sources

GREEN ='\033[0;32m'
RED ='\033[0;31m'

SRC = $(addprefix $(DIRSRC)/, \
		main.c src3.c src.c src2.c)
OBJDIR = objects

OBJ = $(SRC:$(DIRSRC)/%.c= $(OBJDIR)/%.o)

OBJ_PATHS = $(OBJDIR) $(shell ls -R $(DIRSRC) | grep / | sed 's/://g' | sed 's/sources/$(OBJDIR)/g')

HEADERS = $(addprefix $(HEADERS_PATH), \
 philos.h)

all: $(NAME)
	
$(NAME): $(OBJ)
	@gcc $(CFLAGS) $(INCLUDES) -o $@ $^
	@echo "$(GREEN)______________________________________________________"
	@echo "$(GREEN)~####~~##~~##~~####~~~####~~#####~~~####~~~####~~~~###"
	@echo "$(GREEN)##~~~~~##~~##~##~~##~##~~##~##~~~~~##~~~~~##~~~~~~~###"
	@echo "$(GREEN)~####~~##~~##~##~~~~~##~~~~~####~~~~####~~~####~~~~###"
	@echo "$(GREEN)~~~~##~##~~##~##~~##~##~~##~##~~~~~~~~~##~~~~~##"
	@echo "$(GREEN)~####~~~####~~~####~~~####~~#####~~~####~~~####~~~~###"
	@echo "$(GREEN)______________________________________________________"
$(OBJDIR)/%.o: $(DIRSRC)/%.c
	@echo "$(GREEN)Start compiling $<"
	@mkdir -p $(OBJ_PATHS)
	@./pro_bar
	@gcc -c $(CFLAGS) $(INCLUDES) -o $@ -c $<
clean:
	@echo "$(RED)_______________________________________________________________________"
	@echo "$(RED)#####~~#####~~##~~~~~#####~~######~#####  ~####~~#####~~######~~~~~~###"
	@echo "$(RED)##~~##~##~~~~~##~~~~~##~~~~~~~##~~~##     ##~~##~##~~##~~~~~##~~~~~~###"
	@echo "$(RED)##~~##~####~~~##~~~~~####~~~~~##~~~####   ##~~##~#####~~~~~~##~~~~~~###"
	@echo "$(RED)##~~##~##~~~~~##~~~~~##~~~~~~~##~~~##     ##~~##~##~~##~##~~##"
	@echo "$(RED)#####~~#####~~######~#####~~~~##~~~#####  ~####~~#####~~~####~~~~~~~###"
	@echo "$(RED)_______________________________________________________________________"
	@$(RM) $(OBJ)

fclean:
	@echo "$(RED)____________________________________________________________________"
	@echo "$(RED)#####~~#####~~##~~~~~#####~~######~#####  ~####~~##~~~~~##~~~~~~~###"
	@echo "$(RED)##~~##~##~~~~~##~~~~~##~~~~~~~##~~~##     ##~~##~##~~~~~##~~~~~~~###"
	@echo "$(RED)##~~##~####~~~##~~~~~####~~~~~##~~~####   ######~##~~~~~##~~~~~~~###"
	@echo "$(RED)##~~##~##~~~~~##~~~~~##~~~~~~~##~~~##     ##~~##~##~~~~~##"
	@echo "$(RED)#####~~#####~~######~#####~~~~##~~~#####  ##~~##~######~######~~~###"
	@echo "$(RED)____________________________________________________________________"
	@$(RM) $(NAME) $(OBJ)

re: fclean all	

.PHONY: all re clean fclean